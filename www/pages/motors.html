<ons-page id="motors"  class="page__background motors-page">
   
    <ons-toolbar  class="toolbar-background-bl">
     <div class="left">
       <ons-back-button>Back</ons-back-button>
        </div>
        <div class="center" id="toolbar-title" style="color:rgb(255, 255, 255);text-align: center;">Motors</div>
       <div class="right">
      <ons-toolbar-button onclick='gohome();' >  
      <span style="color: rgb(255, 255, 255);">
       <i class="fa-solid fa-home"></i>
     </span>
     </ons-toolbar-button>
    </div>
   </ons-toolbar>

   <ons-carousel fullscreen swipeable auto-scroll overscrollable id="carousel">

    <ons-carousel-item style="margin-top: 25px;" id="left-carousel">
      <div>
        <i class="fa-sharp fa-regular fa-circle-info"></i>
      </div>
<div class="motor-interface">
  <div class="slider-container">
    <div class="slider-background"></div>
    <input type="range" min="-2000" max="2000" value="0" step="1000" class="slider" id="myRange"> 
  </div>
<div class="adjusting">
<div class="screen">
  <div id="slider-value" class="box">
    <span style="margin-left: 8px;" fvar="{name:'ml.s'}"></span>
    <div class="title" style="font-size: small; margin-bottom: 20px; color: aliceblue; margin-left: 40px;">Speed</div>
  </div>
    <div class="box" id="ml-position">

      <span style="margin-left: 20px;" fvar="{name:'ml.p'}"></span>
      <div class="title" style="font-size: small; margin-bottom: 20px; color: aliceblue; margin-left: 40px;">Position</div>
    </div>
    <div class="box" id="ml-inclination"> <span style="margin-left: 19px;" fvar="{name:'a',idx:4}" ></span>
      <div style="font-size: small; color: aliceblue; margin-left:40px;">Inclination</div>
    </div>
  </div>

<div class="buttonContainer">
  <button class="button-m" onclick="motorgo(0,-2000)" >IN</button>
<button class="button-m" onclick="motorgo(0,2000)">OUT</button>
  <button  class="button-m" onclick="motorstop(0)" >STOP</button>
</div>
</div>
</div>

<div id="debugdiv1" >
</div>

  </ons-carousel-item>

  <ons-carousel-item style="background-color: #373B44;" id="right-carousel">
    <div style="text-align: center; font-size: 30px; margin-top: 20px; color: #fff;">
      DARK
    </div>
  </ons-carousel-item>

</ons-carousel>

<script>
const slider = document.getElementById("myRange");
const output = document.getElementById("slider-value");



output.innerHTML = slider.value;

slider.oninput = function() {
  try {
    output.innerHTML = this.value;
    console.log("Slider is changing");
    // Update motor speed value
    motorgo(0, this.value);
  } catch (e) {
    console.log("the slider is not updated anymore, the error:" + e.output);
  }
};




//document.getElementById("stopButton").addEventListener("click", motorstop);

function motorgo(lr,speed){
    var o;
   if (lr==0) {
	   o={do:{ml:{s:speed}}};
	      } 
	  else o={do:{mr:{s:speed}}};
    fble.sendjson(o); 
    document.getElementById("debugdiv1").innerHTML=JSON.stringify(o);
  }
  function motorstop(lr){
    var o;
   if (lr==0) {
	   o={do:{ml:{s:0}}};
	      } 
	   else o={do:{mr:{s:0}}};
           fble.sendjson(o); 
	   document.getElementById("debugdiv1").innerHTML=JSON.stringify(o);
  }

var titleElement = document.getElementById('toolbar-title');

// Set initial toolbar title

titleElement.innerHTML = 'Right Motor';
  //Swipping right/left
  document.addEventListener('DOMContentLoaded', function() {
    var carousel = document.getElementById('left-carousel');
    var titleElement = document.getElementById('toolbar-title');

    carousel.addEventListener('postchange', function(event) {
      if (event.activeIndex === 0) {
        titleElement.innerHTML = 'Right Motor'; 
        console.log("the index page now is: " +event.activeIndex);
      } else if (event.activeIndex === 1) {
        titleElement.innerHTML = 'Left Motor';
        console.log("the tite now is: " +titleElement);
        console.log("the index page now is: " +event.activeIndex);
      }
    });
  });
</script>
</ons-page>









     
